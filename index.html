<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>
<html lang="ja">

<head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
    <meta name='author' content='ChatGPT'>
    <title>Enhanced Text Comparison Tool</title>
    <script type='text/javascript'>
        // 改行・空白を無視した差分比較ロジック
        function getNormalizedText(text) {
            // 改行と余分な空白を統一（1つのスペースに置換）
            return text.replace(/\s+/g, ' ').trim();
        }

        function getCharDifferences(text1, text2) {
            const normalized1 = getNormalizedText(text1);
            const normalized2 = getNormalizedText(text2);

            const len1 = normalized1.length;
            const len2 = normalized2.length;

            let result1 = '';
            let result2 = '';

            let i = 0, j = 0;

            while (i < len1 || j < len2) {
                if (i < len1 && j < len2 && normalized1[i] === normalized2[j]) {
                    // 一致する文字
                    result1 += normalized1[i];
                    result2 += normalized2[j];
                    i++;
                    j++;
                } else {
                    if (i < len1) {
                        // text1にしかない文字を強調
                        result1 += `<span class="highlight-diff">${normalized1[i]}</span>`;
                        i++;
                    }
                    if (j < len2) {
                        // text2にしかない文字を強調
                        result2 += `<span class="highlight-diff">${normalized2[j]}</span>`;
                        j++;
                    }
                }
            }
            return { highlighted1: result1, highlighted2: result2 };
        }

        function compareTexts() {
            const text1 = document.getElementById("text1").value.trim();
            const text2 = document.getElementById("text2").value.trim();

            // オリジナルを維持しながら比較用の正規化を実施
            const { highlighted1, highlighted2 } = getCharDifferences(text1, text2);

            document.getElementById("output1").innerHTML = highlighted1;
            document.getElementById("output2").innerHTML = highlighted2;
        }
    </script>
    <style type='text/css'>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 45%;
            height: 200px;
            margin-bottom: 10px;
        }
        .output {
            width: 45%;
            padding: 10px;
            border: 1px solid #ddd;
            background: #f9f9f9;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .highlight-diff {
            color: red;
            font-weight: bold;
        }
        .description {
            margin-top: 20px;
            font-size: 14px;
            color: #333;
        }
    </style>
</head>

<body>
    <h1>Enhanced Text Comparison Tool</h1>
    <div style="display: flex; justify-content: space-between;">
        <textarea id="text1" placeholder="メモを入力してください"></textarea>
        <textarea id="text2" placeholder="原稿を入力してください"></textarea>
    </div>
    <button onclick="compareTexts()">比較する</button>
    <div style="display: flex; justify-content: space-between; margin-top: 20px;">
        <div id="output1" class="output"></div>
        <div id="output2" class="output"></div>
    </div>
    <div class="description">
        <p>※ 比較結果で<strong>赤色</strong>に強調表示されている部分は、テキスト間で異なる箇所を表しています。</p>
        <p>改行や余分な空白は無視して比較されています。</p>
    </div>
</body>

</html>
